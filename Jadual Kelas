<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Pengurusan Kelas Multi-Theme + Kalendar</title>
    <style>
        /* =========================================
           SISTEM TEMA (CSS VARIABLES)
           ========================================= */

/* 1. TEMA DEFAULT (SUPER MARIO) */
        :root {
            --bg-color: #6b8cff;
            --bg-image: radial-gradient(circle at 20% 20%, white 10%, transparent 10%), radial-gradient(circle at 80% 50%, white 5%, transparent 5%);
            --font-main: "Segoe UI Black", "Arial Rounded MT Bold", "Verdana", sans-serif;
            --container-bg: rgba(255, 255, 255, 0.95);
            --border-style: 3px solid #000;
            --border-radius: 15px;
            --primary-color: #e52521; 
            --secondary-color: #43b047; 
            --accent-color: #fbd000; 
            --text-color: #333;
            --header-shadow: 5px 5px 0px rgba(0,0,0,0.2);
            --btn-shadow: 4px 4px 0 rgba(0,0,0,0.3);
            --table-header-bg: #e52521;
            --table-header-text: #fff;
            --col-hari-bg: #43b047;
            --dock-bg: #d35400;
            --music-bg: #fff;

/* Calendar Specific */
            --cal-month-bg: #fff;
            --cal-header-bg: #e52521;
            --cal-border: 2px solid #000;
            --cal-holiday-public: #ffcccc;
            --cal-holiday-school: #d0f0c0;
            --cal-weekend: #eee;
        }

/* 2. TEMA CALL OF DUTY / STEAM (GAMING) */
        [data-theme="cod"] {
            --bg-color: #0b0c10;
            --bg-image: linear-gradient(45deg, #1f2833 25%, transparent 25%, transparent 75%, #1f2833 75%, #1f2833), linear-gradient(45deg, #1f2833 25%, transparent 25%, transparent 75%, #1f2833 75%, #1f2833);
            --font-main: "Consolas", "Courier New", monospace;
            --container-bg: rgba(11, 12, 16, 0.98);
            --border-style: 2px solid #66fcf1;
            --border-radius: 2px;
            --primary-color: #1f2833; 
            --secondary-color: #45a29e;
            --accent-color: #66fcf1; 
            --text-color: #c5c6c7;
            --header-shadow: 0 0 15px rgba(102, 252, 241, 0.3);
            --btn-shadow: 0 0 5px rgba(102, 252, 241, 0.5);
            --table-header-bg: #1f2833;
            --table-header-text: #66fcf1;
            --col-hari-bg: #0b0c10;
            --dock-bg: #1f2833;
            --music-bg: #0b0c10;

--cal-month-bg: #1f2833;
            --cal-header-bg: #0b0c10;
            --cal-border: 1px solid #45a29e;
            --cal-holiday-public: #3a1c1c; /* Dark Red */
            --cal-holiday-school: #1c3a25; /* Dark Green */
            --cal-weekend: #15191d;
        }

/* 3. TEMA FROZEN (ICE) */
        [data-theme="frozen"] {
            --bg-color: #e3f2fd;
            --bg-image: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(227,242,253,0) 70%);
            --font-main: "Georgia", "Times New Roman", serif;
            --container-bg: rgba(255, 255, 255, 0.9);
            --border-style: 2px solid #81d4fa;
            --border-radius: 25px;
            --primary-color: #4fc3f7; 
            --secondary-color: #b3e5fc;
            --accent-color: #e1bee7; 
            --text-color: #01579b;
            --header-shadow: 0 4px 15px rgba(129, 212, 250, 0.6);
            --btn-shadow: 0 4px 10px rgba(79, 195, 247, 0.4);
            --table-header-bg: #4fc3f7;
            --table-header-text: #fff;
            --col-hari-bg: #81d4fa;
            --dock-bg: #e1f5fe;
            --music-bg: #f0faff;

--cal-month-bg: #fff;
            --cal-header-bg: #81d4fa;
            --cal-border: 1px solid #b3e5fc;
            --cal-holiday-public: #ffebee;
            --cal-holiday-school: #e0f2f1;
            --cal-weekend: #f5f5f5;
        }

/* 4. TEMA KEMERDEKAAN (MALAYSIA) */
        [data-theme="merdeka"] {
            --bg-color: #ffcc00;
            --bg-image: repeating-linear-gradient(45deg, #cc0000 0, #cc0000 10px, #ffffff 10px, #ffffff 20px);
            --font-main: "Impact", "Arial Black", sans-serif;
            --container-bg: #ffffff;
            --border-style: 4px solid #000066;
            --border-radius: 8px;
            --primary-color: #000066; 
            --secondary-color: #cc0000; 
            --accent-color: #ffcc00; 
            --text-color: #000;
            --header-shadow: 8px 8px 0 rgba(0,0,0,0.4);
            --btn-shadow: 4px 4px 0 #000066;
            --table-header-bg: #000066;
            --table-header-text: #ffcc00;
            --col-hari-bg: #cc0000;
            --dock-bg: #ffcc00;
            --music-bg: #ffffff;

--cal-month-bg: #fff;
            --cal-header-bg: #000066;
            --cal-border: 2px solid #000;
            --cal-holiday-public: #ffcccc;
            --cal-holiday-school: #ccffcc;
            --cal-weekend: #eeeeee;
        }

/* =========================================
           GAYA GLOBAL
           ========================================= */

body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            background-image: var(--bg-image);
            background-size: 500px 500px;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background 0.5s ease, color 0.3s ease;
            padding-bottom: 80px;
        }

.theme-switcher-container {
            position: absolute; top: 20px; right: 20px; z-index: 1000;
        }
        #theme-select {
            padding: 8px; border-radius: 8px; border: 2px solid #000;
            font-family: inherit; font-weight: bold; cursor: pointer;
            box-shadow: 3px 3px 0 rgba(0,0,0,0.2); background: #fff;
        }

/* --- MUSIC PLAYER WIDGET --- */
        .music-widget {
            position: fixed; bottom: 20px; right: 20px;
            background-color: var(--music-bg); border: var(--border-style);
            border-radius: var(--border-radius); padding: 10px 15px;
            display: flex; align-items: center; gap: 10px;
            box-shadow: var(--header-shadow); z-index: 2000; transition: all 0.3s ease;
        }
        .music-btn {
            background-color: var(--secondary-color); color: #fff; border: none;
            border-radius: 50%; width: 40px; height: 40px; font-size: 1.2rem;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            border: 2px solid #000; box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
        }
        .music-btn:active { transform: scale(0.95); box-shadow: none; }
        .volume-control { display: flex; flex-direction: column; align-items: center; }
        .volume-label { font-size: 0.7rem; font-weight: bold; margin-bottom: 2px; }
        input[type=range] { width: 80px; accent-color: var(--primary-color); cursor: pointer; }
        [data-theme="cod"] .music-btn { background-color: var(--accent-color); color: #000; border-color: var(--accent-color); }
        [data-theme="cod"] .music-widget { border-color: var(--accent-color); box-shadow: 0 0 10px var(--accent-color); }

/* Header */
        header {
            text-align: center; margin-bottom: 15px; width: 100%; max-width: 1200px;
            background: var(--container-bg); padding: 15px;
            border-radius: var(--border-radius); border: var(--border-style);
            box-shadow: var(--header-shadow); margin-top: 30px; 
        }
        h1 { margin: 0; color: var(--primary-color); text-transform: uppercase; letter-spacing: 2px; font-size: 2.2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.2); }
        [data-theme="cod"] h1 { color: var(--accent-color); text-shadow: 0 0 10px var(--accent-color); }

/* --- NAVIGASI TAB --- */
        .nav-container {
            display: flex; gap: 15px; margin-bottom: 20px; z-index: 20;
            flex-wrap: wrap; justify-content: center;
        }
        .nav-btn {
            padding: 12px 25px; font-size: 1.1rem; font-weight: 900;
            text-transform: uppercase; border: var(--border-style);
            border-radius: var(--border-radius); cursor: pointer;
            background-color: var(--container-bg); color: var(--text-color);
            box-shadow: var(--btn-shadow); transition: transform 0.1s;
        }
        .nav-btn:active { transform: translate(2px, 2px); }
        .nav-btn.active { background-color: var(--accent-color); color: #000; border-color: var(--text-dark); }

/* SECTION VISIBILITY */
        .page-section { display: none; width: 100%; display: flex; flex-direction: column; align-items: center; }
        .page-section.active-section { display: flex; }

/* Input Tajuk */
        #input-tajuk {
            margin-top: 15px; padding: 10px; font-size: 1.2em; text-align: center;
            border: var(--border-style); border-radius: 50px; background: #fff;
            width: 320px; font-weight: bold; color: #333;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
        }
        #input-tajuk:focus { outline: none; border-color: var(--accent-color); }

/* --- CONTAINER ALATAN --- */
        .tools-container { width: 100%; max-width: 850px; display: flex; flex-direction: column; gap: 15px; margin-bottom: 25px; }
        .dock-box {
            background-color: var(--dock-bg); border: var(--border-style);
            border-radius: var(--border-radius); padding: 15px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2); text-align: center; position: relative;
        }
        .dock-box::before, .dock-box::after { content: ''; position: absolute; top: 10px; width: 10px; height: 10px; background: #000; border-radius: 50%; opacity: 0.3; }
        .dock-box::before { left: 10px; } .dock-box::after { right: 10px; }
        [data-theme="frozen"] .dock-box::before, [data-theme="frozen"] .dock-box::after, [data-theme="cod"] .dock-box::before, [data-theme="cod"] .dock-box::after { display: none; }

.dock-title { font-size: 1rem; color: #fff; margin-bottom: 12px; font-weight: bold; text-shadow: 1px 1px 0 #000; text-transform: uppercase; }
        [data-theme="frozen"] .dock-title { color: #0277bd; text-shadow: none; }
        [data-theme="cod"] .dock-title { color: var(--accent-color); text-shadow: 0 0 5px var(--accent-color); }

.icon-dock, .color-dock { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; background: rgba(255,255,255,0.3); padding: 10px; border-radius: 10px; }

/* Updated Item Styles for Click-Select */
        .draggable-item { 
            font-size: 2rem; 
            cursor: pointer; 
            transition: transform 0.2s; 
            user-select: none; 
            padding: 8px; 
            background: #fff; 
            border: 2px solid #000; 
            border-radius: 8px; 
            box-shadow: 3px 3px 0 rgba(0,0,0,0.2); 
        }
        .draggable-item:hover { transform: scale(1.1) rotate(-5deg); background-color: var(--accent-color); }

.item-terpilih {
            background-color: var(--accent-color) !important;
            border-color: red !important;
            transform: scale(1.1);
            box-shadow: 0 0 10px yellow !important;
        }

[data-theme="cod"] .draggable-item { background: #000; border-color: var(--accent-color); color: #fff; box-shadow: 0 0 5px var(--accent-color); }
        [data-theme="frozen"] .draggable-item { border-color: #81d4fa; box-shadow: 0 0 10px #81d4fa; }

.color-swatch { width: 40px; height: 40px; border-radius: 50%; border: 2px solid #000; cursor: pointer; transition: transform 0.2s; box-shadow: 2px 2px 0 rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .color-swatch:hover { transform: scale(1.2); z-index: 10; }

/* --- NEW COLOR WHEEL STYLE --- */
        .custom-color-wrapper {
            background: conic-gradient(red, yellow, lime, aqua, blue, magenta, red);
            overflow: hidden;
            padding: 0;
            position: relative;
        }
        #custom-color-input {
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            border: none;
            padding: 0;
            position: absolute;
            top: 0;
            left: 0;
        }

/* Butang */
        .panel { margin-bottom: 20px; display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
        button { padding: 12px 25px; border: var(--border-style); border-radius: var(--border-radius); font-size: 14px; cursor: pointer; font-weight: 900; text-transform: uppercase; font-family: inherit; display: flex; align-items: center; gap: 8px; position: relative; top: 0; transition: all 0.1s; color: #fff; }
        button:active { top: 4px; box-shadow: none !important; }
        .btn-print { background-color: var(--secondary-color); box-shadow: var(--btn-shadow); color: #fff; }
        .btn-delete-cell { background-color: var(--accent-color); color: #000; box-shadow: var(--btn-shadow); }
        .btn-reset { background-color: var(--primary-color); color: #fff; box-shadow: var(--btn-shadow); }
        .btn-add { background-color: #4fc3f7; color: #000; box-shadow: var(--btn-shadow); }
        [data-theme="cod"] button { color: var(--bg-color); border-color: var(--accent-color); }
        [data-theme="cod"] .btn-delete-cell { background-color: var(--accent-color); }
        [data-theme="cod"] .btn-reset { background-color: #c0392b; color: #fff; }

#status-msg { font-size: 0.9em; background: #000; color: #fff; padding: 5px 15px; border-radius: 20px; opacity: 0; transition: opacity 0.5s; margin-top: 5px; font-weight: bold; }

/* --- TO-DO LIST --- */
        .todo-wrapper { width: 100%; max-width: 800px; display: flex; flex-direction: column; align-items: center; }
        .todo-input-group { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; width: 100%; }
        #input-todo { flex: 1; padding: 15px; font-size: 1.1rem; border: var(--border-style); border-radius: var(--border-radius); outline: none; box-shadow: var(--btn-shadow); }
        #input-todo:focus { border-color: var(--accent-color); }
        .todo-list-container { width: 100%; background: var(--container-bg); border: var(--border-style); border-radius: var(--border-radius); padding: 25px; box-shadow: var(--header-shadow); min-height: 300px; }
        .todo-header { text-align: center; font-size: 1.5rem; font-weight: 900; color: var(--primary-color); text-transform: uppercase; margin-bottom: 20px; text-decoration: underline; text-decoration-thickness: 3px; }
        [data-theme="cod"] .todo-header { color: var(--accent-color); text-decoration: none; border-bottom: 2px solid var(--accent-color); display: inline-block; }
        .todo-item { display: flex; align-items: center; background: rgba(255,255,255,0.8); border: var(--border-style); padding: 15px; margin-bottom: 12px; border-radius: 10px; transition: all 0.2s; }
        [data-theme="cod"] .todo-item { background: #1f2833; border-color: #45a29e; color: #c5c6c7; }
        .todo-item:hover { transform: scale(1.01); }
        .todo-item.completed { background-color: #e8f5e9; opacity: 0.7; }
        [data-theme="cod"] .todo-item.completed { background-color: #0b0c10; opacity: 0.5; }
        .todo-item.completed span { text-decoration: line-through; color: #888; }
        .todo-checkbox { width: 25px; height: 25px; margin-right: 15px; cursor: pointer; accent-color: var(--primary-color); }
        .todo-text { flex: 1; font-size: 1.1rem; font-weight: bold; word-break: break-word; }
        .btn-del-todo { background: var(--primary-color); color: white; border: 2px solid #000; padding: 8px 12px; border-radius: 8px; font-size: 0.9rem; margin-left: 10px; cursor: pointer; }

/* --- TABLE STYLES --- */
        .jadual-wrapper { width: 100%; max-width: 100%; overflow-x: auto; background: var(--container-bg); border: var(--border-style); border-radius: var(--border-radius); box-shadow: var(--header-shadow); padding: 10px; }
        table { width: 100%; min-width: 1000px; border-collapse: separate; border-spacing: 0; border-radius: 10px; table-layout: fixed; }
        th, td { border: 2px solid #000; text-align: center; vertical-align: middle; padding: 0; box-sizing: border-box; }
        [data-theme="frozen"] th, [data-theme="frozen"] td { border-color: #4fc3f7; }
        [data-theme="cod"] th, [data-theme="cod"] td { border-color: #45a29e; }
        [data-theme="merdeka"] th, [data-theme="merdeka"] td { border-color: #000066; }
        th { background-color: var(--table-header-bg); color: var(--table-header-text); padding: 8px; font-size: 1em; font-weight: 900; text-transform: uppercase; position: relative; }
        .resizer { position: absolute; right: 0; top: 0; height: 100%; width: 7px; cursor: col-resize; z-index: 10; }
        .resizer:hover, .resizing { background-color: var(--accent-color); border-right: 2px solid #000; opacity: 1; }
        .header-input { width: 100%; min-height: 25px; padding: 5px 2px; background: var(--container-bg); border: 2px solid transparent; outline: none; text-align: center; font-weight: bold; color: inherit; font-family: inherit; }
        .header-input:focus { background-color: var(--accent-color); color: #000; }
        .col-hari { background-color: var(--col-hari-bg); color: #fff; font-weight: 900; width: 120px; text-transform: uppercase; border-right: 3px solid #000; }
        [data-theme="cod"] .col-hari { border-right: 2px solid #66fcf1; color: #66fcf1; }
        [data-theme="frozen"] .col-hari { border-right: 2px solid #fff; }
        .sel-input { width: 100%; height: 100%; min-height: 55px; padding: 10px 5px; box-sizing: border-box; outline: none; font-size: 1em; line-height: 1.4; display: block; background-color: transparent; transition: border 0.2s; font-weight: 600; overflow: hidden; color: inherit; }
        .sel-input:hover { filter: brightness(0.95); background-color: rgba(255,255,255,0.1); }
        .sel-aktif-highlight { background-color: var(--accent-color) !important; color: #000 !important; box-shadow: inset 0 0 10px rgba(0,0,0,0.2); }
        .row-custom .col-hari { background-color: #fff; color: #333; }
        [data-theme="cod"] .row-custom .col-hari { background-color: #000; color: #ccc; }
        .input-hari-custom { width: 100%; text-align: center; border: none; background: transparent; font-weight: 900; font-style: italic; color: inherit; font-family: inherit; text-transform: uppercase; }

/* --- KALENDAR STYLES (BARU) --- */
        .calendar-controls {
            display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 20px;
            font-size: 1.5rem; font-weight: bold; background: var(--container-bg); padding: 10px 30px;
            border-radius: var(--border-radius); border: var(--border-style); box-shadow: var(--btn-shadow);
        }
        .calendar-controls button {
            background: var(--primary-color); color: white; border: none; width: 40px; height: 40px;
            border-radius: 50%; cursor: pointer; display: flex; justify-content: center; align-items: center;
        }

.legend-container {
            display: flex; gap: 20px; margin-bottom: 20px; font-weight: bold;
            background: rgba(255,255,255,0.8); padding: 10px; border-radius: 10px; border: 2px solid #000;
        }
        [data-theme="cod"] .legend-container { background: #0b0c10; color: #fff; border-color: var(--accent-color); }

.legend-item { display: flex; align-items: center; gap: 8px; }
        .dot { width: 15px; height: 15px; border-radius: 50%; border: 1px solid #000; }
        .dot.public { background-color: var(--cal-holiday-public); }
        .dot.school { background-color: var(--cal-holiday-school); }

.calendar-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; width: 100%; max-width: 1200px;
        }

.month-card {
            background: var(--cal-month-bg); border: var(--cal-border); border-radius: 10px; overflow: hidden;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.1);
        }

.month-header {
            background: var(--cal-header-bg); color: #fff; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;
        }
        [data-theme="cod"] .month-header { color: var(--accent-color); }

.days-grid {
            display: grid; grid-template-columns: repeat(7, 1fr); padding: 10px; gap: 2px;
        }

.day-name {
            font-size: 0.8rem; font-weight: bold; text-align: center; padding: 5px 0; color: var(--text-color); opacity: 0.7;
        }

.day-cell {
            text-align: center; padding: 8px 2px; font-size: 0.9rem; border-radius: 4px; cursor: default;
        }

.day-cell.weekend { background-color: var(--cal-weekend); color: #777; }
        .day-cell.holiday-public { background-color: var(--cal-holiday-public); font-weight: bold; color: #d32f2f; border: 1px solid red; }
        .day-cell.holiday-school { background-color: var(--cal-holiday-school); color: #2e7d32; border: 1px solid green; }
        [data-theme="cod"] .day-cell.holiday-public { color: #ff6b6b; border-color: #ff6b6b; }
        [data-theme="cod"] .day-cell.holiday-school { color: #66ff66; border-color: #66ff66; }

/* --- MEDIA PRINT --- */
        @media print {
            body { background: white; background-image: none; padding: 0; color: black; -webkit-print-color-adjust: exact; padding-bottom: 0; }
            header { box-shadow: none; border: none; padding: 0; margin-top: 0; }
            .theme-switcher-container, .music-widget { display: none !important; }
            h1 { color: black; text-shadow: none; }
            #input-tajuk { border: none; border-bottom: 2px solid #000; box-shadow: none; border-radius: 0; width: 100%; text-align: center; }
            .panel, #status-msg, .tools-container, .resizer, .nav-container, .calendar-controls { display: none; }
            .jadual-wrapper, .todo-list-container, .calendar-grid { box-shadow: none; border: none; overflow: visible; padding: 0; max-width: 100%; }
            table { width: 100%; border: 2px solid #000; border-radius: 0; table-layout: auto; }
            th, td { border: 1px solid #000 !important; color: #000 !important; }
            th { background-color: #ddd !important; text-shadow: none; color: #000 !important; }
            .col-hari { background-color: #eee !important; color: black !important; text-shadow: none; }
            .header-input, .sel-input { box-shadow: none !important; animation: none !important; }
            .page-section { display: none !important; }
            .page-section.active-section { display: flex !important; }
            .todo-input-group { display: none; }
            .todo-list-container { border: 2px solid #000; background: #fff; }
            .btn-del-todo { display: none; }
            .todo-item { border: 1px solid #ccc; break-inside: avoid; background: #fff; color: #000; }
            .sel-input { font-size: 10pt; min-height: 40px; }
            th { font-size: 11pt; }

/* Print Kalendar */
            .calendar-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
            .month-card { border: 1px solid #000; break-inside: avoid; }
            .month-header { background: #eee; color: #000; border-bottom: 1px solid #000; }
            .day-cell.holiday-public { background-color: #ddd !important; border: 1px solid #000; }
            .day-cell.holiday-school { background-color: #f0f0f0 !important; border: 1px dashed #000; }
        }
    </style>
</head>
<body>

<div class="theme-switcher-container">
        <select id="theme-select" onchange="tukarTema(this.value)">
            <option value="mario">üçÑ Theme Mario</option>
            <option value="cod">üî´ Theme Call of Duty/Steam</option>
            <option value="frozen">‚ùÑÔ∏è Theme Frozen</option>
            <option value="merdeka">üá≤üáæ Theme Kemerdekaan</option>
        </select>
    </div>

<div class="music-widget">
        <button class="music-btn" id="play-btn" onclick="toggleMusic()" title="Mainkan/Hentikan Muzik">‚ñ∂Ô∏è</button>
        <div class="volume-control">
            <span class="volume-label">Vol</span>
            <input type="range" id="vol-slider" min="0" max="1" step="0.05" value="0.4" oninput="adjustVolume(this.value)" title="Laras Suara">
        </div>
        <audio id="bg-music" loop>
            <source src="https://arleta.site/interactivelink/800/Jadual-Kelas-Super.mp3" type="audio/mpeg">
        </audio>
    </div>

<header>
        <h1>Sistem Kelas Super</h1>
        <input type="text" id="input-tajuk" placeholder="TULIS NAMA KELAS DI SINI">
        <div id="status-msg">GAME SAVED!</div>
    </header>

<div class="nav-container">
        <button class="nav-btn active" onclick="tukarPage('jadual')">üìÖ JADUAL WAKTU</button>
        <button class="nav-btn" onclick="tukarPage('tugasan')">üßπ JADUAL TUGASAN</button>
        <button class="nav-btn" onclick="tukarPage('todo')">üìù TO-DO LIST</button>
        <button class="nav-btn" onclick="tukarPage('kalendar')">üóìÔ∏è KALENDAR</button>
    </div>

<div id="shared-tools" class="tools-container">
        <div class="dock-box">
            <div class="dock-title">‚≠ê POWER-UPS (KLIK ICON & KLIK JADUAL UNTUK LETAK) ‚≠ê</div>
            <div class="icon-dock">
                <span class="draggable-item" onclick="pilihItem(this)">üçÑ</span>
                <span class="draggable-item" onclick="pilihItem(this)">‚≠ê</span>
                <span class="draggable-item" onclick="pilihItem(this)">üî•</span>
                <span class="draggable-item" onclick="pilihItem(this)">üßπ</span>
                <span class="draggable-item" onclick="pilihItem(this)">ü™£</span>
                <span class="draggable-item" onclick="pilihItem(this)">üóëÔ∏è</span>
                <span class="draggable-item" onclick="pilihItem(this)">üìö</span>
                <span class="draggable-item" onclick="pilihItem(this)">‚öΩ</span>
                <span class="draggable-item" onclick="pilihItem(this)">üé®</span>
                <span class="draggable-item" onclick="pilihItem(this)">üíª</span>
                <span class="draggable-item" onclick="pilihItem(this)">üìù</span>
                <span class="draggable-item" onclick="pilihItem(this)">üç±</span>
            </div>
        </div>
        <div class="dock-box">
            <div class="dock-title">üé® TUKAR WARNA PETAK (KLIK PETAK DULU) üé®</div>
            <div class="color-dock">
                <div class="color-swatch" style="background: #ffcdd2;" onclick="tukarWarna('#ffcdd2')" title="Merah"></div>
                <div class="color-swatch" style="background: #c8e6c9;" onclick="tukarWarna('#c8e6c9')" title="Hijau"></div>
                <div class="color-swatch" style="background: #bbdefb;" onclick="tukarWarna('#bbdefb')" title="Biru"></div>
                <div class="color-swatch" style="background: #fff9c4;" onclick="tukarWarna('#fff9c4')" title="Kuning"></div>
                <div class="color-swatch" style="background: #e1bee7;" onclick="tukarWarna('#e1bee7')" title="Ungu"></div>
                <div class="color-swatch" style="background: #ffe0b2;" onclick="tukarWarna('#ffe0b2')" title="Oren"></div>
                <div class="color-swatch" style="background: #cfd8dc;" onclick="tukarWarna('#cfd8dc')" title="Kelabu"></div>

<div class="color-swatch custom-color-wrapper" title="Pilih Warna Custom">
                    <input type="color" id="custom-color-input" oninput="tukarWarna(this.value)">
                </div>

<div class="color-swatch" style="background: #ffffff; border: 2px dashed #333;" onclick="tukarWarna('')" title="Kosongkan Warna">‚ùå</div>
            </div>
        </div>
    </div>

<div id="section-jadual" class="page-section active-section">
        <div class="panel">
            <button class="btn-delete-cell" onclick="padamSelPilihan()">üßΩ Padam Sel</button>
            <button class="btn-reset" onclick="kosongkanSemua('jadual')">üóëÔ∏è Kosongkan Jadual</button>
            <button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak Jadual</button>
        </div>

<div class="jadual-wrapper">
            <table id="jadualUtama">
                <thead>
                    <tr>
                        <th style="width: 120px">HARI / MASA</th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                        <th><div class="header-input" contenteditable="true"></div></th>
                    </tr>
                </thead>
                <tbody id="tbody-jadual">
                    <tr><td class="col-hari">Isnin</td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td></tr>
                    <tr><td class="col-hari">Selasa</td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td></tr>
                    <tr><td class="col-hari">Rabu</td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td></tr>
                    <tr><td class="col-hari">Khamis</td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td></tr>
                    <tr><td class="col-hari">Jumaat</td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td></tr>
                    <tr class="row-custom">
                        <td class="col-hari" style="background-color: white !important; color: black !important;">
                            <input type="text" id="label-extra" class="input-hari-custom" placeholder="LAIN-LAIN">
                        </td>
                        <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td> <td><div class="sel-input" contenteditable="true"></div></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

<div id="section-tugasan" class="page-section">
        <div class="panel">
            <button class="btn-add" onclick="tambahBarisPelajar()">‚ûï Tambah Murid</button>
            <button class="btn-delete-cell" onclick="padamSelPilihan()">üßΩ Padam Sel</button>
            <button class="btn-reset" onclick="kosongkanSemua('tugasan')">üóëÔ∏è Kosongkan Tugasan</button>
            <button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak Tugasan</button>
        </div>

<div class="jadual-wrapper">
            <table id="jadualTugasan">
                <thead>
                    <tr>
                        <th style="width: 50px;">NO</th>
                        <th style="width: 250px;">NAMA PELAJAR</th>
                        <th>ISNIN</th>
                        <th>SELASA</th>
                        <th>RABU</th>
                        <th>KHAMIS</th>
                        <th>JUMAAT</th>
                        <th style="width: 50px;" class="no-print">‚ùå</th>
                    </tr>
                </thead>
                <tbody id="tbody-tugasan">
                    </tbody>
            </table>
        </div>
    </div>

<div id="section-todo" class="page-section">
        <div class="todo-wrapper">
            <div class="todo-input-group">
                <input type="text" id="input-todo" placeholder="Tulis tugasan baru di sini... (Contoh: Bawa Duit Yuran)">
                <button class="btn-add" onclick="tambahTodo()">‚ûï Tambah</button>
            </div>
            <div class="panel">
                <button class="btn-reset" onclick="kosongkanSemua('todo')">üóëÔ∏è Kosongkan Senarai</button>
                <button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak Senarai</button>
            </div>
            <div class="todo-list-container">
                <div class="todo-header">SENARAI SEMAK KELAS</div>
                <div id="todo-list-items"></div>
                <div id="empty-todo-msg" style="text-align:center; color:#999; margin-top:50px; display:none;">
                    Tiada tugasan. Sila tambah tugasan baru!
                </div>
            </div>
        </div>
    </div>

<div id="section-kalendar" class="page-section">
        <div class="calendar-controls">
            <button onclick="changeYear(-1)">‚óÄ</button>
            <span id="currentYearDisplay">2026</span>
            <button onclick="changeYear(1)">‚ñ∂</button>
        </div>

<div class="legend-container">
            <div class="legend-item"><span class="dot public"></span> Cuti Umum</div>
            <div class="legend-item"><span class="dot school"></span> Cuti Sekolah</div>
        </div>

<div class="panel">
             <button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak Kalendar</button>
        </div>

<div id="calendar-container" class="calendar-grid">
            </div>
    </div>

<script>
        // --- VARIABLES & CONFIG ---
        const KEY_JADUAL = 'jadual_kelas_data_v2';
        const KEY_TUGASAN = 'jadual_tugasan_data_v1';
        const KEY_TODO = 'jadual_todo_data_v1';
        const KEY_THEME = 'selected_theme';
        
        let selTerakhirAktif = null;
        let itemUntukDiletak = null; // Variable baru untuk simpan icon terpilih

        const inputTajuk = document.getElementById('input-tajuk');
        const statusMsg = document.getElementById('status-msg');
        const toolsContainer = document.getElementById('shared-tools');

        // --- MUSIC LOGIC ---
        const audio = document.getElementById('bg-music');
        const playBtn = document.getElementById('play-btn');
        const volSlider = document.getElementById('vol-slider');

        audio.volume = 0.4;
        function toggleMusic() {
            if (audio.paused) {
                audio.play().then(() => { playBtn.innerText = "‚è∏Ô∏è"; }).catch(err => { alert("Sila klik butang Play sekali lagi."); });
            } else {
                audio.pause(); playBtn.innerText = "‚ñ∂Ô∏è";
            }
        }
        function adjustVolume(val) { audio.volume = val; }

        // --- THEME LOGIC ---
        function tukarTema(namaTema) {
            document.body.setAttribute('data-theme', namaTema);
            localStorage.setItem(KEY_THEME, namaTema);
            document.getElementById('theme-select').value = namaTema;
        }
        function loadTema() {
            const savedTheme = localStorage.getItem(KEY_THEME) || 'mario';
            tukarTema(savedTheme);
        }

        // --- NAVIGASI TAB ---
        function tukarPage(page) {
            const sections = document.querySelectorAll('.page-section');
            const btns = document.querySelectorAll('.nav-btn');
            sections.forEach(s => s.classList.remove('active-section'));
            btns.forEach(b => b.classList.remove('active'));

            if (page === 'jadual') {
                document.getElementById('section-jadual').classList.add('active-section');
                btns[0].classList.add('active');
                toolsContainer.style.display = 'flex';
            } else if (page === 'tugasan') {
                document.getElementById('section-tugasan').classList.add('active-section');
                btns[1].classList.add('active');
                toolsContainer.style.display = 'flex';
            } else if (page === 'todo') {
                document.getElementById('section-todo').classList.add('active-section');
                btns[2].classList.add('active');
                toolsContainer.style.display = 'none';
            } else if (page === 'kalendar') {
                document.getElementById('section-kalendar').classList.add('active-section');
                btns[3].classList.add('active');
                toolsContainer.style.display = 'none';
                renderCalendar(); // Render on open
            }
        }

        // --- CALENDAR LOGIC (2026) ---
        let currentYear = 2026;
        
        // Data Cuti (Malaysia 2026 - Anggaran)
        const holidays = {
            "2026-01-01": "Tahun Baru",
            "2026-02-17": "Tahun Baru Cina",
            "2026-02-18": "Tahun Baru Cina",
            "2026-03-20": "Hari Raya Aidilfitri",
            "2026-03-21": "Hari Raya Aidilfitri",
            "2026-05-01": "Hari Pekerja",
            "2026-05-31": "Hari Wesak",
            "2026-06-01": "Hari Keputeraan Agong",
            "2026-06-16": "Awal Muharram",
            "2026-08-31": "Hari Kebangsaan",
            "2026-09-16": "Hari Malaysia",
            "2026-11-08": "Deepavali",
            "2026-12-25": "Hari Krismas"
        };

        // Data Cuti Sekolah (Anggaran KPM)
        const schoolBreaks = [
            { start: "2026-02-15", end: "2026-03-10" }, // Cuti Akhir Persekolahan Sesi Lepas
            { start: "2026-05-25", end: "2026-06-02" }, // Cuti Penggal 1
            { start: "2026-09-14", end: "2026-09-22" }, // Cuti Penggal 2
            { start: "2026-12-20", end: "2026-12-31" }  // Cuti Akhir Tahun
        ];

        function isSchoolHoliday(dateStr) {
            const date = new Date(dateStr);
            for (let breakPeriod of schoolBreaks) {
                const start = new Date(breakPeriod.start);
                const end = new Date(breakPeriod.end);
                if (date >= start && date <= end) return true;
            }
            return false;
        }

        function changeYear(delta) {
            currentYear += delta;
            renderCalendar();
        }

        function renderCalendar() {
            document.getElementById('currentYearDisplay').innerText = currentYear;
            const container = document.getElementById('calendar-container');
            container.innerHTML = '';

            const monthNames = ["Januari", "Februari", "Mac", "April", "Mei", "Jun", "Julai", "Ogos", "September", "Oktober", "November", "Disember"];

            for (let m = 0; m < 12; m++) {
                const monthDiv = document.createElement('div');
                monthDiv.className = 'month-card';

                // Header
                const header = document.createElement('div');
                header.className = 'month-header';
                header.innerText = monthNames[m];
                monthDiv.appendChild(header);

                // Days Grid
                const grid = document.createElement('div');
                grid.className = 'days-grid';

                // Day Names
                const daysShort = ["Ahd", "Isn", "Sel", "Rab", "Kha", "Jum", "Sab"];
                daysShort.forEach(d => {
                    const dn = document.createElement('div');
                    dn.className = 'day-name';
                    dn.innerText = d;
                    grid.appendChild(dn);
                });

                // Calculate Dates
                const firstDay = new Date(currentYear, m, 1).getDay();
                const daysInMonth = new Date(currentYear, m + 1, 0).getDate();

                // Empty cells
                for (let i = 0; i < firstDay; i++) {
                    const empty = document.createElement('div');
                    grid.appendChild(empty);
                }

                // Date cells
                for (let d = 1; d <= daysInMonth; d++) {
                    const cell = document.createElement('div');
                    cell.className = 'day-cell';
                    cell.innerText = d;

                    const dateStr = `${currentYear}-${String(m + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                    const dayOfWeek = new Date(currentYear, m, d).getDay();

                    // Check Holiday
                    if (holidays[dateStr]) {
                        cell.classList.add('holiday-public');
                        cell.title = holidays[dateStr];
                    } else if (isSchoolHoliday(dateStr)) {
                        cell.classList.add('holiday-school');
                        cell.title = "Cuti Sekolah";
                    }

                    // Check Weekend (Friday/Saturday for some states, Sat/Sun for others - default to Sat/Sun visual)
                    if (dayOfWeek === 0 || dayOfWeek === 6) {
                        cell.classList.add('weekend');
                    }

                    grid.appendChild(cell);
                }

                monthDiv.appendChild(grid);
                container.appendChild(monthDiv);
            }
        }

        // --- CORE LOGIC (SHARED) ---
        function attachEvents(elements) {
            elements.forEach(el => {
                el.removeEventListener('input', autoSave); el.removeEventListener('focus', handleFocus);
                // Remove drag events, add click event for placing item
                el.removeEventListener('click', letakItemDalamSel);
                
                el.addEventListener('input', autoSave); 
                el.addEventListener('focus', handleFocus);
                el.addEventListener('click', letakItemDalamSel);
            });
        }
        
        const handleFocus = (e) => setAktif(e.target);

        // --- LOGIK BARU: KLIK ICON & LETAK (Ganti Drag & Drop) ---
        
        // 1. Fungsi pilih icon dari dock
        function pilihItem(el) {
            // Jika icon yang sama diklik lagi, batalkan pemilihan (toggle off)
            if (el.innerText === itemUntukDiletak) {
                itemUntukDiletak = null;
                el.classList.remove('item-terpilih');
                return;
            }

            // Buang class terpilih dari semua item lain
            document.querySelectorAll('.draggable-item').forEach(item => item.classList.remove('item-terpilih'));
            
            // Set item baru
            itemUntukDiletak = el.innerText;
            el.classList.add('item-terpilih');
        }

        // 2. Fungsi letak item dalam sel bila diklik
        function letakItemDalamSel(e) {
            if (itemUntukDiletak) {
                // Tambah icon ke dalam text sedia ada (dengan space jika perlu)
                const currentText = e.target.innerText;
                e.target.innerText = currentText + (currentText.length > 0 && !currentText.endsWith(' ') ? ' ' : '') + itemUntukDiletak;
                autoSave();
            }
            // Tetap jadikan sel aktif untuk penukaran warna dll
            setAktif(e.target);
        }

        // JADUAL
        function loadJadual() {
            const data = JSON.parse(localStorage.getItem(KEY_JADUAL) || '{}');
            inputTajuk.value = data.tajuk || ''; document.getElementById('label-extra').value = data.extraLabel || '';
            const cells = document.querySelectorAll('#tbody-jadual .sel-input');
            const headers = document.querySelectorAll('#section-jadual .header-input');
            if (data.cells) cells.forEach((c, i) => { if(data.cells[i]) { c.innerText = data.cells[i].text; c.style.backgroundColor = data.cells[i].color; }});
            if (data.headers) headers.forEach((h, i) => { if(data.headers[i]) { h.innerText = data.headers[i].text; h.style.backgroundColor = data.headers[i].color; }});
            attachEvents(cells); attachEvents(headers);
        }
        function saveJadual() {
            const cells = document.querySelectorAll('#tbody-jadual .sel-input');
            const headers = document.querySelectorAll('#section-jadual .header-input');
            const data = {
                tajuk: inputTajuk.value, extraLabel: document.getElementById('label-extra').value,
                cells: Array.from(cells).map(c => ({ text: c.innerText, color: c.style.backgroundColor })),
                headers: Array.from(headers).map(h => ({ text: h.innerText, color: h.style.backgroundColor }))
            };
            localStorage.setItem(KEY_JADUAL, JSON.stringify(data));
        }

        // TUGASAN
        function tambahBarisPelajar(nama="", tasks=["","","","",""], colors=["","","","",""]) {
            const tbody = document.getElementById('tbody-tugasan');
            const tr = document.createElement('tr');
            let html = `<td>${tbody.rows.length + 1}</td><td><div class="sel-input" contenteditable="true" placeholder="Nama">${nama}</div></td>`;
            for(let i=0; i<5; i++) html += `<td><div class="sel-input" contenteditable="true" ${colors[i]?`style="background-color:${colors[i]}"`:''}>${tasks[i]}</div></td>`;
            html += `<td class="no-print"><button onclick="buangBaris(this)" style="background:red; color:white; padding:5px; font-size:10px; border:1px solid #000;">üóëÔ∏è</button></td>`;
            tr.innerHTML = html; tbody.appendChild(tr);
            attachEvents(tr.querySelectorAll('.sel-input'));
        }
        function buangBaris(btn) { if(confirm("Buang baris?")) { btn.parentNode.parentNode.remove(); updateNomborTugasan(); autoSave(); } }
        function updateNomborTugasan() { document.querySelectorAll('#tbody-tugasan tr').forEach((row, i) => row.cells[0].innerText = i + 1); }
        function loadTugasan() {
            const data = JSON.parse(localStorage.getItem(KEY_TUGASAN) || '{}');
            const tbody = document.getElementById('tbody-tugasan'); tbody.innerHTML = '';
            if (data.rows && data.rows.length > 0) data.rows.forEach(r => tambahBarisPelajar(r.nama, r.tasks, r.colors));
            else for(let i=0; i<5; i++) tambahBarisPelajar();
        }
        function saveTugasan() {
            const rowData = [];
            document.querySelectorAll('#tbody-tugasan tr').forEach(row => {
                const inputs = row.querySelectorAll('.sel-input');
                const tasks = []; const colors = [];
                for(let i=1; i<=5; i++) { tasks.push(inputs[i].innerText); colors.push(inputs[i].style.backgroundColor); }
                rowData.push({ nama: inputs[0].innerText, tasks, colors });
            });
            localStorage.setItem(KEY_TUGASAN, JSON.stringify({ rows: rowData }));
        }

        // TO-DO
        let todoList = [];
        function loadTodo() { todoList = JSON.parse(localStorage.getItem(KEY_TODO) || '[]'); renderTodo(); }
        function saveTodo() { localStorage.setItem(KEY_TODO, JSON.stringify(todoList)); }
        function tambahTodo() {
            const input = document.getElementById('input-todo');
            if(input.value.trim()) { todoList.push({ text: input.value.trim(), done: false }); input.value = ''; saveTodo(); renderTodo(); tunjukStatus(); }
        }
        function toggleTodo(i) { todoList[i].done = !todoList[i].done; saveTodo(); renderTodo(); }
        function deleteTodo(i) { if(confirm("Padam?")) { todoList.splice(i, 1); saveTodo(); renderTodo(); } }
        function renderTodo() {
            const container = document.getElementById('todo-list-items'); container.innerHTML = '';
            document.getElementById('empty-todo-msg').style.display = todoList.length ? 'none' : 'block';
            todoList.forEach((todo, i) => {
                container.innerHTML += `<div class="todo-item ${todo.done?'completed':''}"><input type="checkbox" class="todo-checkbox" onchange="toggleTodo(${i})" ${todo.done?'checked':''}><span class="todo-text">${todo.text}</span><button class="btn-del-todo" onclick="deleteTodo(${i})">‚ùå</button></div>`;
            });
        }
        document.getElementById('input-todo').addEventListener('keypress', (e) => { if(e.key==='Enter') tambahTodo(); });

        // GENERAL
        function autoSave() { saveJadual(); saveTugasan(); tunjukStatus(); }
        function setAktif(el) { if (selTerakhirAktif) selTerakhirAktif.classList.remove('sel-aktif-highlight'); selTerakhirAktif = el; selTerakhirAktif.classList.add('sel-aktif-highlight'); }
        function tukarWarna(color) { if (selTerakhirAktif) { selTerakhirAktif.style.backgroundColor = color; autoSave(); selTerakhirAktif.focus(); } else alert("Klik petak dahulu!"); }
        function padamSelPilihan() { if (selTerakhirAktif) { selTerakhirAktif.innerText = ''; autoSave(); selTerakhirAktif.focus(); } else alert("Klik petak dahulu!"); }
        function kosongkanSemua(type) {
            if(!confirm("Pasti padam?")) return;
            if(type === 'jadual') { localStorage.removeItem(KEY_JADUAL); loadJadual(); }
            else if(type === 'tugasan') { localStorage.removeItem(KEY_TUGASAN); loadTugasan(); }
            else if(type === 'todo') { todoList=[]; saveTodo(); renderTodo(); }
            tunjukStatus();
        }
        function tunjukStatus() { statusMsg.style.opacity = '1'; setTimeout(() => { statusMsg.style.opacity = '0'; }, 1000); }
        const setupResizers = () => {
            document.querySelectorAll('#jadualUtama th').forEach(th => {
                const resizer = document.createElement('div'); resizer.className = 'resizer'; th.appendChild(resizer);
                let x = 0, w = 0;
                const md = (e) => { x = e.clientX; w = parseInt(window.getComputedStyle(th).width, 10); document.addEventListener('mousemove', mm); document.addEventListener('mouseup', mu); resizer.classList.add('resizing'); };
                const mm = (e) => { th.style.width = `${w + e.clientX - x}px`; };
                const mu = () => { document.removeEventListener('mousemove', mm); document.removeEventListener('mouseup', mu); resizer.classList.remove('resizing'); };
                resizer.addEventListener('mousedown', md);
            });
        }

        // INIT
        document.addEventListener('DOMContentLoaded', () => {
            loadTema(); loadJadual(); loadTugasan(); loadTodo(); renderCalendar(); setupResizers();
            inputTajuk.addEventListener('input', autoSave);
            document.getElementById('label-extra').addEventListener('input', autoSave);
        });
    </script>
<script>
  // Disable right click
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
  });

  // Disable key shortcuts
  document.addEventListener('keydown', function(e) {
    if (
      e.key === 'F12' ||
      (e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key)) ||
      (e.ctrlKey && e.key === 'U')
    ) {
      e.preventDefault();
    }
  });
</script>
</body>
</html>
